<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <link rel="stylesheet" type="text/css" href="css/lib/smoothness/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="js/lib/DataTables-1.10.10/css/dataTables.jqueryui.css"/>
    <link rel="stylesheet" type="text/css" href="css/multi-msa-editor.css">

    <script type="text/javascript" src="js/lib/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="js/lib/jquery-ui-1.11.4.js"></script>
    <script type="text/javascript" src="js/lib/jquery.jeditable.js"></script>
    <script type="text/javascript" src="js/lib/FileSaver.js"></script>
    <script type="text/javascript" src="js/lib/undomanager.js"></script>
    <script type="text/javascript" src="js/lib/papaparse.js"></script>
    <script type="text/javascript" src="js/lib/DataTables-1.10.10/js/jquery.dataTables.js"></script>
    <script type="text/javascript" src="js/lib/DataTables-1.10.10/js/dataTables.jqueryui.js"></script>
    <script type="text/javascript" src="js/cell-style.js"></script>
    <script type="text/javascript" src="js/msa-editor.js"></script>
    <script type="text/javascript" src="js/multi-msa-editor.js"></script>
</head>

<body>
  <div id="tabs">
    <ul>
      <li><a href="#tsv_viewer">TSV Viewer</a></li>
      <li><a href="#editor_tab">Editor</a></li>
    </ul>
    <div id="tsv_viewer">
      <div style='display:flex'>
	<input type="file" id="file" name="file" onchange="openFile(this.files)" />
	<input id="save" type="button" onclick="saveFile()" disabled value="Save" />
      </div>
      <table id="data_table">
	<tfoot>
	  <tr></tr>
        </tfoot>
	<tbody id="data_table_body"></tbody>
      </table>
    </div>
    <div id="editor_tab">
      <div class="flex-column" style="display: inline-block">
	<div class="flex">
          <label for="name_col" style="flex-grow: 1">Name Column</label>
          <select id="name_col" name="name_col"></select>
	</div>
	<div class="flex">
          <label for="alignment_col" style="flex-grow: 1">Alignment Column</label>
          <select id="alignment_col" name="alignment_col"></select>
	</div>
      </div>
      <div>
        <button id="init_editor" type="button" onclick="initEditor()">Load from TSV</button>
	<button id="apply_changes" type="button" onclick="applyChanges()" disabled>Apply changes to TSV</button>
	<button id="minimize" type="button" onclick="executeOperation(removeGapColumnsForActive)" disabled>Minimize</button>
	<button id="undo_button" type="button" onclick="undoManager.undo();" disabled>Undo</button>
	<button id="redo_button" type="button" onclick="undoManager.redo();" disabled>Redo</button>
	<button type="button" onclick="showHelpWindow();">Help</button>
      </div>
      <br>
      <div id="msa-editor">
        <table id="msa_sticky_header_table" class='floating-header'>
	  <tbody id="msa_sticky_header_body"></tbody>
        </table>
        <table id="msa_table">
	  <thead id="msa_head"></thead>
	  <tbody id="msa_body"></tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="cell_edit_dialog" title="Edit Cell" style='display: none'>
    <input type="text" name="cell_content" id="cell_content" class="text ui-widget-content ui-corner-all">
  </div>

  <div id="help_window" title="Help" style='display: none'>
    <p>You can use the "Browse" button to select and load one or more MSA files
      into the application. After that you can switch between different files
      by using the provided drop down menu. The application has two modes: View
      mode and Edit mode. View mode is the initial mode after loading or
      selecting a new file and displays the alignment data contained in the
      file. Edit mode removes duplicate entries with the same pronunciation and
      enables the key and mouse bindings to change the alignment.
    </p>
    <h3>Edit mode</h3>
    <p>The following tables use the following abbreviations for modifier keys,
      which can be applied to change the executed commands:
    </p>
    <table class="helptable">
      <tr><td>A</td><td>Alt key</td></tr>
      <tr><td>C</td><td>Ctrl/Cmd key (labeled different on Win/Mac respectively)</td></tr>
      <tr><td>S</td><td>Shift key</td></tr>
    </table>
    <h4>Mouse-Bindings</h4>

    <table class="helptable">
      <tbody>
	<tr>
	  <th>Key</th>
	  <th>Effect</th>
        </tr>
	<tr>
	  <td class="center">Click</td>
	  <td>Start new selection</td>
        </tr>
	<tr>
	  <td class="center">S-Click</td>
	  <td>Extend current celection</td>
        </tr>
	<tr>
	  <td class="center">DblClick</td>
	  <td>Edit activated cell</td>
        </tr>
      </tbody>
    </table>

    <h4>Key-Bindings</h4>
    <table class="helptable">
      <tbody>
	<tr>
	  <th>Key</th>
	  <th>Effect</th>
        </tr>
	<tr>
	  <td>v</td>
	  <td>Switch to view mode</td>
        </tr>
	<tr>
	  <td>u</td>
	  <td>Undo</td>
        </tr>
	<tr>
	  <td>r</td>
	  <td>Redo</td>
        </tr>
	<tr>
	  <td>s</td>
	  <td>Save</td>
        </tr>
	<tr>
	  <td>m</td>
	  <td>Minimize</td>
        </tr>
	<tr>
	  <td>e</td>
	  <td>Edit activated cell</td>
        </tr>
	<tr>
	  <td>&#8592;&#8593;&#8594;&#8595;</td>
	  <td>Move selection start corner</td>
        </tr>
	<tr>
	  <td>S-[&#8592;&#8593;&#8594;&#8595;]</td>
	  <td>Extend selection</td>
        </tr>
	<tr>
	  <td>C-[&#8592;&#8594;]</td>
	  <td>Move selected cells</td>
        </tr>
	<tr>
	  <td>C-[&#8593;&#8595;]</td>
	  <td>Move selected rows up or down. When saving, comments in the
	    original file other than at the start of the file won't be preserved.</td>
        </tr>

	<tr>
	  <td>[Delete Backspace]</td>
	  <td>Delete selected cells and fill the gap from right</td>
        </tr>
	<tr>
	  <td>C-[Del Backspace]</td>
	  <td>Delete selected cells and fill the gap from left</td>
        </tr>
	<tr>
	  <td>Return</td>
	  <td>Merge selected cells into one cell and fill the gap from right</td>
        </tr>
	<tr>
	  <td>C - Return</td>
	  <td>Merge selected cells into one cell and fill the gap from left</td>
        </tr>
	<tr>
	  <td>S - Return</td>
	  <td>Split selected cells into code points and extend to the right</td>
        </tr>
	<tr>
	  <td>CS - Return</td>
	  <td>Split selected cells into code points and extend to the left</td>
        </tr>

      </tbody>
    </table>
  </div>  
<script>
  window.onload = multiMSAEditorOnLoad;
</script>
</body>
</html>
